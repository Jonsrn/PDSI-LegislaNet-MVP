<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Portal da Transpar√™ncia - Legisla Net</title>

    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üèõÔ∏è</text></svg>">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">

    <link rel="stylesheet" href="../css/portal.css">
    <link rel="stylesheet" href="../css/animations.css">
    <link rel="stylesheet" href="../css/global.css">

    <style>
        /* ESTILOS ESPEC√çFICOS DO PORTAL P√öBLICO */
        
        /* --- Live Session Section --- */
        #live-session {
            background: var(--background-dark);
        }
        .live-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 24px;
        }
        .live-dot {
            width: 12px;
            height: 12px;
            background-color: var(--accent-red);
            border-radius: 50%;
            animation: pulse 2s infinite;
            transition: all 0.3s ease;
        }

        .live-dot.ended {
            background-color: #666;
            animation: none;
        }
        .live-grid-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 32px;
            align-items: flex-start;
        }
        .video-placeholder {
            width: 100%;
            aspect-ratio: 16/9;
            background-color: #000;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 16px;
            color: var(--secondary-text);
        }
        .video-placeholder i {
            font-size: 4rem;
            color: var(--border-color);
        }

        .livestream-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
            color: white;
            padding: 20px;
        }

        .livestream-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 8px;
            line-height: 1.3;
        }

        .livestream-meta {
            display: flex;
            gap: 16px;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .livestream-meta span {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .session-info {
            background-color: var(--background-light);
            padding: 32px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
        }
        .session-meta {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 24px;
        }
        .meta-item h4 {
            color: var(--accent-blue);
            margin-bottom: 6px;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .meta-item p {
            font-size: 1rem;
            font-weight: 600;
        }
        .voting-display {
            background-color: var(--background-dark);
            padding: 10px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            min-height: 320px;
        }
        .vote-counts {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-bottom: 16px;
        }
        .vote-count {
            text-align: center;
            padding: 16px 8px;
            border-radius: 10px;
        }
        .vote-count.favor {
            background-color: rgba(46, 160, 67, 0.2);
            border: 1px solid rgba(46, 160, 67, 0.5);
        }
        .vote-count.against {
            background-color: rgba(248, 81, 73, 0.2);
            border: 1px solid rgba(248, 81, 73, 0.5);
        }
        .vote-count.abstention {
            background-color: rgba(212, 175, 55, 0.2);
            border: 1px solid rgba(212, 175, 55, 0.5);
        }
        .vote-count .number {
            font-size: 2.5rem;
            font-weight: 700;
            display: block;
            line-height: 1;
        }
        .vote-count span:not(.number) {
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--secondary-text);
        }
        .vote-count.favor span:not(.number) { color: var(--accent-green); }
        .vote-count.against span:not(.number) { color: var(--accent-red); }
        .vote-count.abstention span:not(.number) { color: var(--accent-gold); }

        /* --- Pr√≥ximas Sess√µes Section --- */
        .loading-message {
            text-align: center;
            padding: 3rem;
            color: var(--secondary-text);
        }

        .loading-message i {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--accent-blue);
        }

        /* Grid est√°tico para at√© 4 sess√µes */
        .sessoes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 24px;
            justify-content: center;
        }

        /* Carrossel para mais de 4 sess√µes */
        .sessoes-carousel-wrapper {
            position: relative;
            overflow: hidden;
            width: 100%;
            border-radius: 8px;
            display: flex;
            justify-content: center;
        }

        .sessoes-carousel {
            display: flex;
            transition: transform 0.5s ease-in-out;
            will-change: transform;
        }

        .sessao-card {
            background-color: var(--card-bg);
            padding: 24px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            min-height: 250px;
            position: relative;
            overflow: hidden;
            justify-content: space-between;
            width: 320px;
            margin-right: 24px;
            text-align: left;
        }

        .sessao-card:hover {
            transform: translateY(-2px);
            border-color: var(--accent-blue);
        }

        /* Container para cabe√ßalho do card */
        .sessao-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start; /* Alinhar no topo */
            margin-bottom: 8px;
            min-height: 28px; /* Altura m√≠nima para o badge */
        }

        .sessao-date {
            color: var(--accent-gold);
            font-weight: 600;
            margin-bottom: 0;
            flex: 1;
            margin-right: 12px; /* Espa√ßo entre data e badge */
            line-height: 1.3;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .sessao-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--primary-text);
            min-height: 2.5em;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            transition: color 0.2s ease;
        }

        /* Badge de tipo da sess√£o */
        .tipo-badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 99px;
            font-weight: 600;
            font-size: 0.7rem;
            text-align: center;
            white-space: nowrap;
            text-transform: uppercase;
            border: 1px solid;
            flex-shrink: 0; /* N√£o permitir que o badge encolha */
            align-self: flex-start; /* Alinhar no topo */
        }

        .tipo-badge.ordinaria {
            background-color: rgba(46, 160, 67, 0.2);
            color: #71e67f;
            border-color: rgba(46, 160, 67, 0.5);
        }

        .tipo-badge.extraordinaria {
            background-color: rgba(255, 159, 10, 0.2);
            color: #ff9f0a;
            border-color: rgba(255, 159, 10, 0.5);
        }

        .tipo-badge.solene {
            background-color: rgba(138, 43, 226, 0.2);
            color: #9d4edd;
            border-color: rgba(138, 43, 226, 0.5);
        }

        /* Se√ß√£o de pautas */
        .sessao-pautas-title {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--secondary-text);
            margin-bottom: 8px;
        }

        .sessao-pautas-list {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 80px;
            overflow: hidden;
        }

        .sessao-pautas-item {
            color: var(--secondary-text);
            font-size: 0.875rem;
            padding: 4px 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .sessao-pautas-item + .sessao-pautas-item {
            border-top: 1px solid var(--border-color);
            margin-top: 8px;
            padding-top: 8px;
        }


        /* Controles do carrossel */
        .carousel-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .carousel-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            color: var(--primary-text);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .carousel-btn:hover:not(.disabled) {
            background-color: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
        }

        .carousel-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .carousel-indicators {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .carousel-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--border-color);
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .carousel-dot.active {
            background-color: var(--accent-blue);
        }

        /* --- Vereadores Section --- */
        .vereadores-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 24px;
            justify-content: center;
            padding: 0 20px;
        }

        .vereadores-grid-static {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            gap: 24px;
            flex-wrap: wrap;
            padding: 0 20px;
        }

        .vereadores-carousel-wrapper {
            width: 100%;
            overflow: hidden;
            position: relative;
            -webkit-mask-image: linear-gradient(to right, transparent, black 5%, black 95%, transparent);
            mask-image: linear-gradient(to right, transparent, black 5%, black 95%, transparent);
        }

        .vereadores-carousel {
            display: flex;
            transition: transform 0.5s ease-in-out;
            will-change: transform;
        }

        .vereador-card {
            width: 280px;
            margin-right: 24px;
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            flex-shrink: 0;
        }

        .vereador-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 16px;
            border: 3px solid var(--accent-blue);
            object-fit: cover;
        }

        .vereador-name {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary-text);
        }

        .vereador-party {
            color: var(--secondary-text);
            margin-bottom: 16px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .partido-logo {
            width: 30px;
            height: 30px;
            object-fit: contain;
            background-color: #fff;
            border-radius: 4px;
            padding: 2px;
            border: 1px solid var(--border-color);
            flex-shrink: 0;
        }

        .vereador-cargo {
            text-align: left;
            line-height: 1.2;
        }

        /* Estilo espec√≠fico para bot√£o desabilitado com badge */
        .btn.btn-outline:disabled {
            opacity: 0.7;
            cursor: not-allowed !important;
            border-color: var(--border-color);
            color: var(--secondary-text);
        }

        .btn.btn-outline:disabled:hover {
            transform: none;
            border-color: var(--border-color);
        }

        /* Flag "Em breve" */
        .coming-soon-flag {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            background: rgba(255, 159, 10, 0.1);
            color: #ff9f0a;
            border: 1px solid rgba(255, 159, 10, 0.3);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Offline Badge */
        .offline-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(128, 128, 128, 0.1);
            color: var(--secondary-text);
            border: 1px solid rgba(128, 128, 128, 0.3);
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .offline-badge i {
            opacity: 0.6;
        }

        /* Vota√ß√£o Ao Vivo Badge */
        .live-voting-badge {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 14px;
            background: linear-gradient(135deg, rgba(248, 81, 73, 0.2) 0%, rgba(240, 136, 51, 0.2) 100%);
            border: 1px solid rgba(248, 81, 73, 0.4);
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--accent-red);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            animation: fadeIn 0.3s ease;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .live-voting-dot {
            width: 8px;
            height: 8px;
            background-color: var(--accent-red);
            border-radius: 50%;
            animation: pulseLive 2s infinite;
            box-shadow: 0 0 8px rgba(248, 81, 73, 0.6);
            flex-shrink: 0;
        }

        @keyframes pulseLive {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.3);
                opacity: 0.7;
            }
        }

        .vereadores-online-count {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            color: var(--primary-text);
            font-weight: 600;
            padding-left: 10px;
            border-left: 1px solid rgba(255, 255, 255, 0.3);
            white-space: nowrap;
        }

        .vereadores-online-count i {
            color: var(--accent-orange);
            font-size: 0.85rem;
        }

        .voting-header {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 16px;
            text-align: center;
        }

        .voting-title-wrapper {
            flex: 1;
            min-width: 0;
        }

        .voting-title {
            margin: 0;
            font-size: 1.15rem;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .voting-badges-wrapper {
            display: flex;
            gap: 8px;
            justify-content: right;
            align-items: flex-start;
        }


        .vereador-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .vereador-stats .stat-item {
            text-align: center;
        }

        .vereador-stats .number {
            display: block;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--accent-blue);
        }

        .vereador-stats .label {
            font-size: 0.8rem;
            color: var(--secondary-text);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Controles do carrossel de vereadores */
        .vereadores-carousel-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .vereadores-carousel-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            color: var(--primary-text);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .vereadores-carousel-btn:hover {
            background-color: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
        }

        .vereadores-info {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            font-size: 0.9rem;
            color: var(--secondary-text);
        }

        /* Mensagens de erro */
        .error-message {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--secondary-text);
            background-color: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.2);
            border-radius: 8px;
            margin: 2rem 0;
        }

        .error-message i {
            font-size: 3rem;
            color: rgba(239, 68, 68, 0.7);
            margin-bottom: 1rem;
        }

        .error-message p {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--primary-text);
        }

        .error-message small {
            font-size: 0.9rem;
            color: var(--secondary-text);
        }

        /* Estado vazio - seguindo padr√£o do painel de vota√ß√£o */
        .empty-state {
            text-align: center;
            padding: 48px;
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin: 2rem 0;
        }

        .empty-state i {
            font-size: 3rem;
            color: var(--secondary-text);
            margin-bottom: 16px;
            display: block;
        }

        .empty-state h3 {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-text);
            margin-bottom: 8px;
        }

        .empty-state p {
            color: var(--secondary-text);
            font-size: 1rem;
            line-height: 1.5;
            margin-bottom: 0;
        }

        /* --- Votes Section --- */
        .votes-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .votes-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px 24px;
            margin-bottom: 32px;
        }

        .votes-footer {
            text-align: center;
        }

        /* Centralizar loading de vota√ß√µes */
        #votacoes-loading {
            grid-column: 1 / -1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 3rem;
            color: var(--secondary-text);
        }

        #votacoes-loading i {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--accent-blue);
        }
        .vote-card {
            background-color: var(--background-light);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            min-height: 140px;
            transition: all 0.2s ease;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .vote-card.clickable-card {
            cursor: pointer;
        }

        .vote-card:hover {
            transform: translateY(-2px);
            border-color: var(--accent-blue);
            box-shadow: 0 4px 12px rgba(88, 166, 255, 0.1);
        }

        .vote-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
            min-height: 28px; /* Altura m√≠nima para o badge */
        }

        .vote-title {
            flex: 1;
            margin-right: 12px; /* Espa√ßo entre t√≠tulo e badge */
            font-size: 1rem;
            font-weight: 600;
            line-height: 1.3;
            color: var(--primary-text);
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .vote-badge-container {
            flex-shrink: 0;
            align-self: flex-start;
        }

        .vote-info {
            display: flex;
            flex-direction: column;
            flex: 1;
            justify-content: space-between;
            min-height: 80px;
        }

        .vote-arrow {
            position: absolute;
            bottom: 16px;
            right: 16px;
            color: var(--secondary-text);
            font-size: 1.2rem;
        }

        .vote-card:hover .result-badge {
            transform: scale(1.05);
        }

        .vote-card:hover .vote-arrow i {
            color: var(--accent-blue);
            transform: translateX(4px);
        }

        .vote-arrow i {
            transition: all 0.2s ease;
        }

        .vote-description {
            color: var(--secondary-text);
            font-size: 0.85rem;
            line-height: 1.4;
            margin: 12px 0;
            font-style: italic;
            flex: 1;
            min-height: 40px; /* Altura m√≠nima para consist√™ncia */
            display: -webkit-box;
            -webkit-line-clamp: 2; /* Limitar a 2 linhas */
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .vote-author {
            color: var(--secondary-text);
            font-size: 0.8rem;
            margin: 0;
            font-weight: 500;
            flex-shrink: 0;
            padding-bottom: 32px; /* Espa√ßo para a seta */
        }
        .vote-result {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        .result-badge {
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            white-space: nowrap;
            flex-shrink: 0; /* N√£o permitir que o badge encolha */
            align-self: flex-start; /* Alinhar no topo */
        }
        .result-badge.approved {
            background-color: rgba(46, 160, 67, 0.2);
            color: var(--accent-green);
        }
        .result-badge.rejected {
            background-color: rgba(248, 81, 73, 0.2);
            color: var(--accent-red);
        }
        .result-badge.pending {
            background-color: rgba(212, 175, 55, 0.2);
            color: var(--accent-gold);
        }
        .result-badge.not-voted {
            background-color: rgba(108, 117, 125, 0.2);
            color: #6c757d;
        }

        /* --- Members Carousel --- */
        .carousel-wrapper {
            width: 100%;
            overflow: hidden;
            -webkit-mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);
            mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);
        }
        .carousel-wrapper:hover .members-carousel {
            animation-play-state: paused;
        }
        .members-carousel {
            display: flex;
            width: calc(304px * 6);
            animation: scroll-members 30s linear infinite;
        }
        @keyframes scroll-members {
            0% { transform: translateX(0); }
            100% { transform: translateX(calc(-304px * 3)); }
        }
        .member-card {
            width: 280px;
            flex-shrink: 0;
            margin: 0 12px;
            background-color: var(--background-light);
            padding: 24px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            text-align: center;
            transition: transform 0.2s;
        }
        .member-card:hover {
            transform: translateY(-2px);
        }
        .member-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 16px;
            border: 3px solid var(--accent-blue);
        }
        .member-name {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 4px;
        }
        .member-party {
            color: var(--accent-gold);
            margin-bottom: 12px;
        }
        .member-stats {
            display: flex;
            justify-content: space-between;
            text-align: center;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--border-color);
        }
        .stat-item .number {
            font-weight: 700;
            color: var(--accent-blue);
            display: block;
        }
        .stat-item .label {
            font-size: 0.8rem;
            color: var(--secondary-text);
        }

        /* --- Livestream Section --- */
        .livestream-container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .livestream-player-wrapper {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .livestream-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
            background: linear-gradient(135deg, var(--card-bg) 0%, var(--hover-bg) 100%);
        }

        .livestream-status {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-badge.live {
            background: linear-gradient(45deg, #ff4444, #ff6666);
            color: white;
            animation: pulse 2s infinite;
        }

        .status-badge.ended {
            background: linear-gradient(45deg, #666, #888);
            color: white;
        }

        .status-badge i {
            font-size: 0.75rem;
            animation: inherit;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .viewer-count {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 8px;
            background-color: var(--hover-bg);
            border-radius: 12px;
            font-size: 0.875rem;
            color: var(--secondary-text);
        }

        .livestream-header h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary-text);
            margin: 0;
            line-height: 1.3;
        }

        .livestream-player {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            background-color: #000;
        }

        .youtube-embed {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .youtube-embed iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .livestream-info {
            padding: 16px 24px;
            background-color: var(--hover-bg);
        }

        .livestream-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: var(--secondary-text);
        }

        .start-time, .duration {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .start-time::before {
            content: "‚è∞";
        }

        .duration::before {
            content: "‚è±Ô∏è";
        }

        /* Estados espec√≠ficos para live vs gravado */
        .livestream-section.live .livestream-player-wrapper {
            border: 2px solid #ff4444;
            box-shadow: 0 0 20px rgba(255, 68, 68, 0.3);
        }

        .livestream-section.ended .livestream-player-wrapper {
            border: 2px solid var(--border-color);
        }

        .livestream-section.live #livestream-title {
            color: #ff4444;
        }

        .livestream-section.ended #livestream-title {
            color: var(--secondary-text);
        }

        /* Badge do portal p√∫blico */
        .portal-badge {
            background-color: var(--accent-red);
            color: #ffffff;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 4px 8px;
            border-radius: 12px;
            letter-spacing: 0.5px;
            animation: pulse 2s infinite;
            white-space: nowrap;
            text-transform: uppercase;
        }

        .portal-badge.ended {
            background-color: var(--secondary-text);
            animation: none;
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .livestream-header {
                padding: 16px 20px;
            }

            .livestream-header h3 {
                font-size: 1.25rem;
            }

            .livestream-info {
                padding: 12px 20px;
            }

            .livestream-meta {
                flex-direction: column;
                gap: 8px;
                align-items: flex-start;
            }
        }

        /* --- Transparency Section --- */
        #transparency {
            background-color: var(--background-light);
        }
        .docs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .doc-card {
            background-color: var(--background-dark);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 16px;
            transition: transform 0.2s;
        }
        .doc-card:hover {
            transform: translateY(-2px);
        }
        .doc-icon {
            font-size: 2rem;
            color: var(--accent-blue);
        }
        .doc-info h4 {
            margin-bottom: 4px;
        }
        .doc-info .date {
            color: var(--secondary-text);
            font-size: 0.9rem;
        }

        /* --- Estilos para informa√ß√µes da c√¢mara na navbar --- */
        .camara-info-nav {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background-color: rgba(88, 166, 255, 0.1);
            border: 1px solid rgba(88, 166, 255, 0.3);
            border-radius: 8px;
            color: var(--accent-blue);
            font-size: 0.9rem;
            font-weight: 600;
            margin-right: 2rem;
        }

        .camara-info-nav i {
            font-size: 0.9rem;
        }

        /* Melhorias no hero para c√¢mara espec√≠fica */
        .hero-camara-title {
            font-size: 1.2rem;
            color: var(--accent-blue);
            font-weight: 600;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* --- Responsividade --- */
        @media (max-width: 992px) {
            .live-grid-container {
                grid-template-columns: 1fr;
            }
            .camara-info-nav {
                margin-right: 1rem;
                margin-bottom: 1rem;
            }
        }
        @media (max-width: 768px) {
            .hero h1 { font-size: 2.5rem; }
            .section-header h2 { font-size: 2rem; }
            .vote-counts { grid-template-columns: 1fr; gap: 12px; }
            .nav-menu { display: none; }
            .camara-info-nav {
                margin-right: 0;
                margin-bottom: 1rem;
                font-size: 0.8rem;
            }
            .nav-menu-wrapper {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container nav-container">
            <a href="selecionar_camara.html" class="nav-logo">
                <svg viewBox="0 0 44 40" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" stop-color="var(--accent-blue)" /><stop offset="100%" stop-color="var(--accent-green)" />
                        </linearGradient>
                    </defs>
                    <path fill="url(#logoGradient)" d="M 8 5 V 35 H 14 V 5 Z M 19 5 V 35 H 25 V 5 Z M 30 5 V 35 H 36 V 5 Z M 5 35 H 39 V 40 H 5 Z" />
                </svg>
                <span>Legisla Net</span>
            </a>
            <div class="nav-menu-wrapper">
                <div class="camara-info-nav">
                    <i class="fas fa-university"></i>
                    <span id="camaraNomeNav">Carregando...</span>
                </div>
                <ul class="nav-menu">
                    <li><a href="#agenda">Agenda</a></li>
                    <li><a href="#votes">Vota√ß√µes</a></li>
                    <li><a href="#members">Vereadores</a></li>
                </ul>
                <a href="selecionar_camara.html" class="btn btn-outline btn-cta">Trocar C√¢mara</a>
            </div>
        </div>
    </nav>

    <header class="hero hero-live-border">
        <div class="container hero-content">
            <div class="hero-camara-title" id="heroSubtitle"></div>
            <h1 id="heroTitle">Carregando informa√ß√µes da c√¢mara...</h1>
            <p id="heroDescription">Acompanhe sess√µes ao vivo, consulte vota√ß√µes e projetos. Participe da vida legislativa da sua cidade.</p>
        </div>
    </header>

    <main>
        <section id="live-session" class="section fade-in">
            <div class="container">
                <div class="section-header fade-in">
                    <div class="live-indicator">
                        <div class="live-dot" id="live-dot"></div>
                        <h2 class="status-live" id="session-status-title">SESS√ÉO AO VIVO</h2>
                    </div>
                    <p>Acompanhe a sess√£o ordin√°ria em tempo real</p>
                </div>
                
                <div class="live-grid-container fade-in">
                    <div class="video-placeholder" id="video-container">
                        <!-- Placeholder inicial -->
                        <div id="video-placeholder-content">
                            <i class="fas fa-play-circle"></i>
                            <p>Carregando transmiss√£o...</p>
                        </div>

                        <!-- Player YouTube (oculto inicialmente) -->
                        <div id="youtube-player"
                             style="display: none; width: 100%; height: 100%;">
                        </div>

                        <!-- Informa√ß√µes da livestream -->
                        <div id="livestream-info" class="livestream-overlay" style="display: none;">
                            <div class="livestream-title" id="livestream-video-title"></div>
                            <div class="livestream-meta">
                                <span id="livestream-viewer-count" style="display: none;"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="session-info">
                        <div class="session-meta" id="session-meta-container">
                            <!-- Ser√° preenchido dinamicamente -->
                        </div>

                        <div class="voting-display" id="voting-display-container">
                            <!-- Ser√° preenchido dinamicamente -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="proximas-sessoes" class="section fade-in">
            <div class="container">
                <div class="section-header fade-in">
                    <h2>Pr√≥ximas Sess√µes</h2>
                    <p>Agenda das pr√≥ximas reuni√µes da c√¢mara municipal</p>
                </div>

                <div id="sessoes-container" class="fade-in">
                    <!-- Sess√µes ser√£o carregadas dinamicamente -->
                    <div id="sessoes-loading" class="loading-message">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Carregando pr√≥ximas sess√µes...</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="votes" class="section fade-in">
            <div class="container">
                <div class="section-header fade-in">
                    <h2>Vota√ß√µes Recentes</h2>
                    <p>Resultado das √∫ltimas vota√ß√µes realizadas</p>
                </div>

                <div class="votes-container fade-in">
                    <div id="votacoes-grid" class="votes-grid">
                        <!-- Pautas ser√£o carregadas dinamicamente -->
                        <div id="votacoes-loading" class="loading-message">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>Carregando vota√ß√µes recentes...</p>
                        </div>
                    </div>

                    <div class="votes-footer">
                        <button id="ver-todas-pautas" class="btn btn-outline" disabled>
                            Ver Todas as Pautas
                            <span class="coming-soon-flag"><i class="fas fa-clock"></i>Em breve</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <section id="members" class="section fade-in">
            <div class="container">
                <div class="section-header fade-in">
                    <h2>Nossos Vereadores</h2>
                    <p>Conhe√ßa os representantes eleitos da nossa cidade</p>
                </div>
            </div>

            <div id="vereadores-container" class="fade-in">
                <!-- Vereadores ser√£o carregados dinamicamente -->
                <div id="vereadores-loading" class="loading-message">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>Carregando vereadores...</p>
                </div>
            </div>
        </section>

        <section id="transparency" class="section fade-in">
            <div class="container">
                <div class="section-header fade-in">
                    <h2>Portal da Transpar√™ncia <span class="coming-soon-flag"><i class="fas fa-clock"></i>Em breve</span></h2>
                    <p>Acesse documentos, atas e relat√≥rios p√∫blicos</p>
                </div>
                
                <div class="docs-grid fade-in">
                    <div class="doc-card"><i class="fas fa-file-alt doc-icon"></i><div class="doc-info"><h4>Ata da Sess√£o Ordin√°ria</h4><p class="date">15 de Agosto, 2025</p></div></div>
                    <div class="doc-card"><i class="fas fa-chart-bar doc-icon"></i><div class="doc-info"><h4>Relat√≥rio Financeiro</h4><p class="date">Julho 2025</p></div></div>
                    <div class="doc-card"><i class="fas fa-gavel doc-icon"></i><div class="doc-info"><h4>Projetos em Tramita√ß√£o</h4><p class="date">Atualizado hoje</p></div></div>
                    <div class="doc-card"><i class="fas fa-users doc-icon"></i><div class="doc-info"><h4>Registro de Presen√ßas</h4><p class="date">Agosto 2025</p></div></div>
                </div>
            </div>
        </section>
        
        <footer class="footer">
            <div class="container footer-container">
                <p>&copy; 2025 C√¢mara Municipal. Portal desenvolvido com Legisla Net.</p>
                <div class="footer-social">
                    <a href="#" title="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" title="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" title="YouTube"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
        </footer>

    <!-- YouTube Player API -->
    <script src="https://www.youtube.com/iframe_api"></script>
    <!-- Socket.IO Client -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="../js/global.js"></script>
    <script>
        // Vari√°veis globais
        let youtubePlayer = null;
        let socket = null;
        let currentCamaraId = null;
        let socketVotacaoAoVivo = null; // Socket para vota√ß√£o ao vivo (porta 3000)
        let votacaoAoVivoAtiva = null; // Dados da vota√ß√£o ativa

        // Fun√ß√£o chamada quando a API do YouTube estiver pronta (deve ser global)
        window.onYouTubeIframeAPIReady = function() {
            console.log('üì∫ YouTube API carregada e pronta');
        };

        // Inicializar WebSocket
        function initializeWebSocket() {
            if (!currentCamaraId) return;

            console.log('üîå Inicializando WebSocket...');

            // Conectar ao servidor global (mesma porta da aplica√ß√£o)
            socket = io();

            socket.on('connect', () => {
                console.log('üîå WebSocket conectado:', socket.id);

                // Entrar na sala da c√¢mara (livestreams)
                socket.emit('join-camara', currentCamaraId);
                console.log(`üì° Entrou na sala da c√¢mara: ${currentCamaraId}`);

                // Entrar na sala do portal da c√¢mara (vota√ß√µes recentes)
                socket.emit('join-portal-camara', currentCamaraId);
                console.log(`üè° Entrou no portal da c√¢mara: ${currentCamaraId}`);
            });

            socket.on('disconnect', () => {
                console.log('üîå WebSocket desconectado');
            });

            socket.on('reconnect', () => {
                console.log('üîÑ WebSocket reconectado');
                if (currentCamaraId) {
                    socket.emit('join-camara', currentCamaraId);
                    socket.emit('join-portal-camara', currentCamaraId);
                }
            });

            // Escutar atualiza√ß√µes de livestream
            socket.on('livestream-updated', (eventData) => {
                console.log('üì∫ Atualiza√ß√£o de livestream recebida:', eventData);

                // Verificar se √© da c√¢mara atual
                if (eventData.camaraId === currentCamaraId) {
                    // Atualizar livestream na interface
                    displayLivestream(eventData.livestreamData, eventData.isLive);
                }
            });

            // Escutar pauta finalizada (vota√ß√µes recentes)
            socket.on('pauta-finalizada', (eventData) => {
                console.log('üó≥Ô∏è Pauta finalizada recebida:', eventData);

                // Verificar se √© da c√¢mara atual
                if (eventData.camaraId === currentCamaraId) {
                    console.log('üîÑ Atualizando vota√ß√µes recentes com nova pauta finalizada');

                    // Tentar chamar addPautaToVotacoesRecentes com pequenas tentativas
                    const tryAddPauta = (attempt = 0) => {
                        try {
                            if (typeof addPautaToVotacoesRecentes === 'function') {
                                addPautaToVotacoesRecentes(eventData.pauta);
                                return;
                            }

                            if (attempt < 3) {
                                // aguardar um pouco e tentar novamente (cuidado com race de carregamento de scripts)
                                setTimeout(() => tryAddPauta(attempt + 1), 250);
                                return;
                            }

                            // √öltimo recurso: tentar inserir a pauta diretamente no DOM (fallback sem depend√™ncias)
                            console.warn('addPautaToVotacoesRecentes n√£o definida ap√≥s tentativas ‚Äî inserindo pauta diretamente no DOM');
                            try {
                                const container = document.getElementById('votacoes-grid');
                                if (container) {
                                    const pauta = eventData.pauta || {};

                                    const statusText = (p) => {
                                        if (!p) return 'Pendente';
                                        switch (p) {
                                            case 'Aprovada': return 'APROVADA';
                                            case 'Reprovada': return 'REPROVADA';
                                            case 'N√£o Votada': return 'N√ÉO VOTADA';
                                            default: return p || 'Pendente';
                                        }
                                    };

                                    const statusClass = (p) => {
                                        if (!p) return 'pending';
                                        switch (p) {
                                            case 'Aprovada': return 'approved';
                                            case 'Reprovada': return 'rejected';
                                            default: return 'pending';
                                        }
                                    };

                                    const descricaoLimitada = pauta.descricao && pauta.descricao.length > 100
                                        ? pauta.descricao.substring(0, 100) + '...'
                                        : pauta.descricao || 'Descri√ß√£o n√£o informada';

                                    const cardHTML = `
                                        <div class="vote-card clickable-card" data-pauta-id="${pauta.id}">
                                            <div class="vote-card-header">
                                                <div class="vote-title">${pauta.nome || 'Sem t√≠tulo'}</div>
                                                <div class="vote-badge-container">
                                                    <div class="result-badge ${statusClass(pauta.resultado_votacao)}">${statusText(pauta.resultado_votacao)}</div>
                                                </div>
                                            </div>
                                            <div class="vote-info">
                                                <p class="vote-description">${descricaoLimitada}</p>
                                                <p class="vote-author">Autor: ${pauta.autor || 'Autor n√£o informado'}</p>
                                            </div>
                                            <div class="vote-arrow">
                                                <i class="fas fa-arrow-right"></i>
                                            </div>
                                        </div>
                                    `;

                                    // Inserir no in√≠cio
                                    container.insertAdjacentHTML('afterbegin', cardHTML);

                                    // Manter apenas 9 pautas
                                    const allCards = container.querySelectorAll('.vote-card');
                                    if (allCards.length > 9) {
                                        allCards[allCards.length - 1].remove();
                                    }

                                    // Reconfigurar event listeners se a fun√ß√£o existir
                                    if (typeof addVotacaoClickListeners === 'function') {
                                        addVotacaoClickListeners();
                                    }
                                } else {
                                    console.warn('Container de vota√ß√µes n√£o encontrado para inserir pauta diretamente');
                                }
                            } catch (domErr) {
                                console.error('Erro ao inserir pauta diretamente no DOM:', domErr);
                            }
                        } catch (err) {
                            console.error('Erro ao processar pauta-finalizada:', err);
                            // S√≥ chamar loadVotacoesRecentes se ela existir para evitar ReferenceError
                            if (typeof loadVotacoesRecentes === 'function' && currentCamaraId) {
                                loadVotacoesRecentes(currentCamaraId);
                            }
                        }
                    };

                    tryAddPauta();
                }
            });

            socket.on('connect_error', (error) => {
                console.error('üîå Erro de conex√£o WebSocket:', error);
            });
        }

        // Inicializar WebSocket para Vota√ß√£o Ao Vivo (porta 3000)
        function initializeVotacaoAoVivoWebSocket() {
            if (typeof io === 'undefined') {
                console.warn('‚ö†Ô∏è Socket.IO n√£o dispon√≠vel para vota√ß√£o ao vivo');
                return;
            }

            try {
                console.log('üîå [VOTACAO_AO_VIVO] Conectando ao servidor global (porta 3000)...');

                socketVotacaoAoVivo = io('http://localhost:3000', {
                    transports: ['websocket', 'polling'],
                    timeout: 3000,
                    reconnection: true,
                    reconnectionDelay: 1000,
                    reconnectionDelayMax: 3000,
                    maxReconnectionAttempts: 10
                });

                socketVotacaoAoVivo.on('connect', () => {
                    console.log('‚úÖ [VOTACAO_AO_VIVO] Conectado ao servidor global');
                });

                socketVotacaoAoVivo.on('disconnect', () => {
                    console.log('‚ùå [VOTACAO_AO_VIVO] Desconectado do servidor global');
                    votacaoAoVivoAtiva = null;
                    updateVotacaoAoVivoUI();
                });

                socketVotacaoAoVivo.on('connect_error', (error) => {
                    console.error('‚ùå [VOTACAO_AO_VIVO] Erro de conex√£o:', error.message);
                });

                // Evento principal: atualiza√ß√£o de vota√ß√£o ao vivo
                socketVotacaoAoVivo.on('votacao-ao-vivo-update', (data) => {
                    console.log('üì° [VOTACAO_AO_VIVO] Evento recebido:', data);

                    // Verificar se √© da c√¢mara atual
                    if (data.camaraId && data.camaraId.toString() === currentCamaraId?.toString()) {
                        console.log(`‚úÖ [VOTACAO_AO_VIVO] Vota√ß√£o ${data.status} - ${data.vereadoresOnline} vereadores online`);

                        if (data.isLive) {
                            votacaoAoVivoAtiva = {
                                pautaId: data.pautaId,
                                pautaNome: data.pautaNome,
                                pautaDescricao: data.pautaDescricao || '',
                                sessaoNome: data.sessaoNome || '',
                                sessaoTipo: data.sessaoTipo || '',
                                sessaoDataHora: data.sessaoDataHora || null,
                                vereadoresOnline: data.vereadoresOnline,
                                timestamp: data.timestamp
                            };
                        } else {
                            // Vota√ß√£o encerrada
                            votacaoAoVivoAtiva = null;
                        }

                        updateVotacaoAoVivoUI();
                    }
                });

                console.log('‚úÖ [VOTACAO_AO_VIVO] WebSocket inicializado');

            } catch (error) {
                console.error('‚ùå [VOTACAO_AO_VIVO] Erro ao inicializar WebSocket:', error);
            }
        }

        // Atualizar UI de vota√ß√£o ao vivo
        function updateVotacaoAoVivoUI() {
            const votingDisplay = document.querySelector('.voting-display');
            if (!votingDisplay) {
                console.warn('‚ö†Ô∏è [VOTACAO_AO_VIVO] Container .voting-display n√£o encontrado');
                return;
            }

            if (votacaoAoVivoAtiva) {
                // MODO AO VIVO - substituir placeholders por dados reais

                // Limitar descri√ß√£o a 200 caracteres
                let descricaoTexto = votacaoAoVivoAtiva.pautaDescricao || '';
                if (descricaoTexto.length > 200) {
                    descricaoTexto = descricaoTexto.substring(0, 200) + '...';
                }
                const descricaoHtml = descricaoTexto
                    ? `<p style="margin: 12px 0 20px 0; color: var(--secondary-text); font-size: 0.9rem; line-height: 1.5; text-align: center;">${descricaoTexto}</p>`
                    : '';

                votingDisplay.innerHTML = `
                    <div style="display: flex; flex-direction: column; min-height: 450px;">
                        <div style="flex: 1;">
                            <div class="voting-header">
                                <div class="voting-badges-wrapper">
                                    <span class="live-voting-badge">
                                        <div class="live-voting-dot"></div>
                                        <span>AO VIVO</span>
                                        <span class="vereadores-online-count">
                                            <i class="fas fa-users"></i>
                                            <span>${votacaoAoVivoAtiva.vereadoresOnline}</span>
                                        </span>
                                    </span>
                                </div>
                                <div class="voting-title-wrapper">
                                    <h4 class="voting-title" style="margin-top: 15px;">${votacaoAoVivoAtiva.pautaNome}</h4>
                                </div>
                            </div>
                            ${descricaoHtml}
                        </div>
                        <div style="margin-top: auto; padding-bottom: 30px;">
                            <div id="vote-counts-container" class="vote-counts">
                                <div class="vote-count favor"><span class="number">0</span><span>A Favor</span></div>
                                <div class="vote-count against"><span class="number">0</span><span>Contra</span></div>
                                <div class="vote-count abstention"><span class="number">0</span><span>Absten√ß√£o</span></div>
                            </div>
                            <p style="text-align: center; color: var(--secondary-text); font-size: 0.9rem; margin-top: 16px;">
                                <span class="status-live">‚óè</span> Vota√ß√£o em andamento
                            </p>
                        </div>
                    </div>
                `;

                console.log(`‚úÖ [VOTACAO_AO_VIVO] UI atualizada - ${votacaoAoVivoAtiva.vereadoresOnline} vereadores online`);

                // Iniciar conex√£o com WebSocket de votos para atualiza√ß√£o em tempo real
                connectToVotacaoWebSocket(votacaoAoVivoAtiva.pautaId);

            } else {
                // MODO OFFLINE - mostrar estado padr√£o
                votingDisplay.innerHTML = `
                    <div class="voting-header">
                        <div class="voting-badges-wrapper">
                            <span class="offline-badge">
                                <i class="fas fa-circle"></i>
                                <span>OFFLINE</span>
                            </span>
                        </div>
                        <div class="voting-title-wrapper">
                            <h4 class="voting-title">Vota√ß√£o em Tempo Real</h4>
                        </div>
                    </div>
                    <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 60px 20px; gap: 16px;">
                        <i class="fas fa-vote-yea" style="font-size: 3.5rem; color: var(--border-color); opacity: 0.5;"></i>
                        <p style="color: var(--secondary-text); font-size: 1rem; text-align: center; margin: 0;">
                            Nenhuma vota√ß√£o ativa no momento
                        </p>
                        <p style="color: var(--secondary-text); font-size: 0.85rem; text-align: center; margin: 0; opacity: 0.7;">
                            Os votos ser√£o exibidos aqui quando uma sess√£o estiver em andamento
                        </p>
                    </div>
                `;

                console.log('üì¥ [VOTACAO_AO_VIVO] Modo offline');
            }

            // Atualizar informa√ß√µes da sess√£o
            updateSessionMeta(votacaoAoVivoAtiva);
        }

        // Atualizar meta informa√ß√µes da sess√£o
        async function updateSessionMeta(votacaoData) {
            const sessionMetaContainer = document.getElementById('session-meta-container');
            if (!sessionMetaContainer) return;

            if (votacaoData && votacaoData.sessaoNome) {
                // Vota√ß√£o em andamento - usar data da sess√£o do WebSocket se dispon√≠vel
                if (votacaoData.sessaoDataHora) {
                    // Usar data que veio do WebSocket
                    const sessaoDataHora = new Date(votacaoData.sessaoDataHora);
                    const dataFormatada = sessaoDataHora.toLocaleDateString('pt-BR', {
                        day: '2-digit',
                        month: 'long',
                        year: 'numeric'
                    });
                    const horaFormatada = sessaoDataHora.toLocaleTimeString('pt-BR', {
                        hour: '2-digit',
                        minute: '2-digit'
                    });

                    sessionMetaContainer.innerHTML = `
                        <div class="meta-item">
                            <h4>Data/Hora</h4>
                            <p>${dataFormatada} - ${horaFormatada}</p>
                        </div>
                        <div class="meta-item">
                            <h4>Tipo de Sess√£o</h4>
                            <p>${votacaoData.sessaoTipo || 'Sess√£o'} - ${votacaoData.sessaoNome}</p>
                        </div>
                    `;
                } else {
                    // Fallback: buscar data da sess√£o via API
                    try {
                        const response = await fetch(`/api/camaras/${currentCamaraId}/sessoes-futuras`);
                        if (response.ok) {
                            const result = await response.json();
                            const sessoesFuturas = Array.isArray(result) ? result : (result.data || []);

                            const hoje = new Date();
                            const hojeStr = hoje.toISOString().split('T')[0];

                            const sessaoHoje = sessoesFuturas.find(sessao => {
                                const sessaoData = new Date(sessao.data_hora_inicio);
                                const sessaoStr = sessaoData.toISOString().split('T')[0];
                                return sessaoStr === hojeStr;
                            });

                            if (sessaoHoje) {
                                const sessaoDataHora = new Date(sessaoHoje.data_hora_inicio);
                                const dataFormatada = sessaoDataHora.toLocaleDateString('pt-BR', {
                                    day: '2-digit',
                                    month: 'long',
                                    year: 'numeric'
                                });
                                const horaFormatada = sessaoDataHora.toLocaleTimeString('pt-BR', {
                                    hour: '2-digit',
                                    minute: '2-digit'
                                });

                                sessionMetaContainer.innerHTML = `
                                    <div class="meta-item">
                                        <h4>Data/Hora</h4>
                                        <p>${dataFormatada} - ${horaFormatada}</p>
                                    </div>
                                    <div class="meta-item">
                                        <h4>Tipo de Sess√£o</h4>
                                        <p>${votacaoData.sessaoTipo || 'Sess√£o'} - ${votacaoData.sessaoNome}</p>
                                    </div>
                                `;
                            } else {
                                // Fallback: usar data atual
                                const agora = new Date();
                                const dataFormatada = agora.toLocaleDateString('pt-BR', {
                                    day: '2-digit',
                                    month: 'long',
                                    year: 'numeric'
                                });
                                const horaFormatada = agora.toLocaleTimeString('pt-BR', {
                                    hour: '2-digit',
                                    minute: '2-digit'
                                });

                                sessionMetaContainer.innerHTML = `
                                    <div class="meta-item">
                                        <h4>Data/Hora</h4>
                                        <p>${dataFormatada} - ${horaFormatada}</p>
                                    </div>
                                    <div class="meta-item">
                                        <h4>Tipo de Sess√£o</h4>
                                        <p>${votacaoData.sessaoTipo || 'Sess√£o'} - ${votacaoData.sessaoNome}</p>
                                    </div>
                                `;
                            }
                        } else {
                            // Fallback se API falhar: usar data atual
                            const agora = new Date();
                            const dataFormatada = agora.toLocaleDateString('pt-BR', {
                                day: '2-digit',
                                month: 'long',
                                year: 'numeric'
                            });
                            const horaFormatada = agora.toLocaleTimeString('pt-BR', {
                                hour: '2-digit',
                                minute: '2-digit'
                            });

                            sessionMetaContainer.innerHTML = `
                                <div class="meta-item">
                                    <h4>Data/Hora</h4>
                                    <p>${dataFormatada} - ${horaFormatada}</p>
                                </div>
                                <div class="meta-item">
                                    <h4>Tipo de Sess√£o</h4>
                                    <p>${votacaoData.sessaoTipo || 'Sess√£o'} - ${votacaoData.sessaoNome}</p>
                                </div>
                            `;
                        }
                    } catch (error) {
                        console.error('Erro ao buscar data da sess√£o:', error);
                        // Fallback em caso de erro: usar data atual
                        const agora = new Date();
                        const dataFormatada = agora.toLocaleDateString('pt-BR', {
                            day: '2-digit',
                            month: 'long',
                            year: 'numeric'
                        });
                        const horaFormatada = agora.toLocaleTimeString('pt-BR', {
                            hour: '2-digit',
                            minute: '2-digit'
                        });

                        sessionMetaContainer.innerHTML = `
                            <div class="meta-item">
                                <h4>Data/Hora</h4>
                                <p>${dataFormatada} - ${horaFormatada}</p>
                            </div>
                            <div class="meta-item">
                                <h4>Tipo de Sess√£o</h4>
                                <p>${votacaoData.sessaoTipo || 'Sess√£o'} - ${votacaoData.sessaoNome}</p>
                            </div>
                        `;
                    }
                }
            } else {
                // Offline - verificar se existe sess√£o agendada para hoje
                try {
                    const response = await fetch(`/api/camaras/${currentCamaraId}/sessoes-futuras`);
                    if (response.ok) {
                        const result = await response.json();
                        // A API pode retornar { data: [...] } ou um array direto
                        const sessoesFuturas = Array.isArray(result) ? result : (result.data || []);

                        // Verificar se tem sess√£o hoje
                        const hoje = new Date();
                        const hojeStr = hoje.toISOString().split('T')[0]; // YYYY-MM-DD

                        const sessaoHoje = sessoesFuturas.find(sessao => {
                            const sessaoData = new Date(sessao.data_hora_inicio);
                            const sessaoStr = sessaoData.toISOString().split('T')[0];
                            return sessaoStr === hojeStr;
                        });

                        if (sessaoHoje) {
                            // Sess√£o agendada para hoje - mostrar informa√ß√µes da sess√£o
                            const sessaoDataHora = new Date(sessaoHoje.data_hora_inicio);
                            const sessaoDataFormatada = sessaoDataHora.toLocaleDateString('pt-BR', {
                                day: '2-digit',
                                month: 'long',
                                year: 'numeric'
                            });
                            const sessaoHoraFormatada = sessaoDataHora.toLocaleTimeString('pt-BR', {
                                hour: '2-digit',
                                minute: '2-digit'
                            });

                            sessionMetaContainer.innerHTML = `
                                <div class="meta-item">
                                    <h4>Data/Hora</h4>
                                    <p>${sessaoDataFormatada} - ${sessaoHoraFormatada}</p>
                                </div>
                                <div class="meta-item">
                                    <h4>Tipo de Sess√£o</h4>
                                    <p>${sessaoHoje.tipo || 'Sess√£o'} - ${sessaoHoje.nome}</p>
                                </div>
                            `;
                        } else {
                            // Nenhuma sess√£o hoje - mostrar aguardando
                            sessionMetaContainer.innerHTML = `
                                <div class="meta-item">
                                    <h4>Data/Hora</h4>
                                    <p>Aguardando...</p>
                                </div>
                                <div class="meta-item">
                                    <h4>Tipo de Sess√£o</h4>
                                    <p>Aguardando pr√≥xima sess√£o</p>
                                </div>
                            `;
                        }
                    } else {
                        // Fallback se API falhar - mostrar aguardando
                        sessionMetaContainer.innerHTML = `
                            <div class="meta-item">
                                <h4>Data/Hora</h4>
                                <p>Aguardando...</p>
                            </div>
                            <div class="meta-item">
                                <h4>Tipo de Sess√£o</h4>
                                <p>Aguardando pr√≥xima sess√£o</p>
                            </div>
                        `;
                    }
                } catch (error) {
                    console.error('Erro ao buscar sess√µes futuras:', error);
                    // Fallback em caso de erro - mostrar aguardando
                    sessionMetaContainer.innerHTML = `
                        <div class="meta-item">
                            <h4>Data/Hora</h4>
                            <p>Aguardando...</p>
                        </div>
                        <div class="meta-item">
                            <h4>Tipo de Sess√£o</h4>
                            <p>Aguardando pr√≥xima sess√£o</p>
                        </div>
                    `;
                }
            }
        }

        // Conectar ao WebSocket de votos para atualizar contadores em tempo real
        function connectToVotacaoWebSocket(pautaId) {
            if (!socket) {
                console.warn('‚ö†Ô∏è [VOTACAO_AO_VIVO] Socket principal n√£o dispon√≠vel, tentando novamente em 1s');
                setTimeout(() => connectToVotacaoWebSocket(pautaId), 1000);
                return;
            }

            if (!socket.connected) {
                console.warn('‚ö†Ô∏è [VOTACAO_AO_VIVO] Socket n√£o conectado, aguardando conex√£o...');
                socket.once('connect', () => {
                    console.log('‚úÖ [VOTACAO_AO_VIVO] Socket conectado, entrando na sala da pauta');
                    connectToVotacaoWebSocket(pautaId);
                });
                return;
            }

            console.log(`üîå [VOTACAO_AO_VIVO] Conectando √† sala da pauta ${pautaId} para receber votos`);

            // Entrar na sala da pauta espec√≠fica no servidor global
            socket.emit('join-room', `pauta_public_${pautaId}`);

            // Confirmar entrada na sala
            socket.once('room-joined', (data) => {
                console.log('‚úÖ [VOTACAO_AO_VIVO] Entrada na sala confirmada:', data);
            });

            // Escutar atualiza√ß√µes de votos - evento correto do tablet backend
            socket.off('voto-notification-public'); // Remover listener anterior se existir
            socket.on('voto-notification-public', (notification) => {
                console.log('üó≥Ô∏è [VOTACAO_AO_VIVO] Voto recebido via WebSocket:', notification);

                if (notification.pautaId && notification.pautaId.toString() === pautaId.toString()) {
                    updateVoteCounters(notification);
                }
            });

            // Escutar estat√≠sticas p√∫blicas (fallback)
            socket.off('pauta-stats-update-public');
            socket.on('pauta-stats-update-public', (data) => {
                console.log('üìä [VOTACAO_AO_VIVO] Estat√≠sticas recebidas:', data);
                if (data.pautaId === pautaId && data.estatisticas) {
                    updateVoteCountersUI(
                        data.estatisticas.sim || 0,
                        data.estatisticas.nao || 0,
                        data.estatisticas.abstencao || 0
                    );
                }
            });

            // Buscar votos atuais
            fetchVotosAtuais(pautaId);

            console.log('‚úÖ [VOTACAO_AO_VIVO] Listeners configurados, aguardando confirma√ß√£o da sala');
        }

        // Buscar votos atuais da pauta
        async function fetchVotosAtuais(pautaId) {
            try {
                const response = await fetch(`/api/votos/pauta/${pautaId}/publico`);
                if (!response.ok) throw new Error('Erro ao buscar votos');

                const data = await response.json();
                const votos = data.votos || [];

                // Calcular totais
                const favor = votos.filter(v => v.voto === 'SIM').length;
                const contra = votos.filter(v => v.voto === 'N√ÉO').length;
                const abstencao = votos.filter(v => v.voto === 'ABSTEN√á√ÉO').length;

                // Atualizar UI
                updateVoteCountersUI(favor, contra, abstencao);

            } catch (error) {
                console.error('‚ùå [VOTACAO_AO_VIVO] Erro ao buscar votos:', error);
            }
        }

        // Atualizar contadores de votos na UI
        function updateVoteCountersUI(favor, contra, abstencao) {
            const voteNumbers = document.querySelectorAll('#vote-counts-container .vote-count .number');
            if (voteNumbers.length >= 3) {
                voteNumbers[0].textContent = favor;
                voteNumbers[1].textContent = contra;
                voteNumbers[2].textContent = abstencao;
            }
        }

        // Atualizar contadores quando voto √© registrado
        function updateVoteCounters(notification) {
            console.log('üîÑ [VOTACAO_AO_VIVO] Atualizando contadores com notifica√ß√£o:', notification);

            const voteNumbers = document.querySelectorAll('#vote-counts-container .vote-count .number');
            if (voteNumbers.length < 3) {
                console.warn('‚ö†Ô∏è [VOTACAO_AO_VIVO] Contadores n√£o encontrados na UI');
                return;
            }

            // Se for atualiza√ß√£o de voto, recarregar todos os votos
            if (notification.isUpdate) {
                console.log('üîÑ [VOTACAO_AO_VIVO] Voto atualizado, recarregando contadores completos');
                fetchVotosAtuais(notification.pautaId);
                return;
            }

            // Incrementar o contador apropriado para novo voto
            const voto = notification.voto;
            console.log('‚ûï [VOTACAO_AO_VIVO] Incrementando contador para:', voto);

            if (voto === 'SIM') {
                const current = parseInt(voteNumbers[0].textContent) || 0;
                voteNumbers[0].textContent = current + 1;
                console.log(`‚úÖ [VOTACAO_AO_VIVO] SIM: ${current} ‚Üí ${current + 1}`);
            } else if (voto === 'N√ÉO') {
                const current = parseInt(voteNumbers[1].textContent) || 0;
                voteNumbers[1].textContent = current + 1;
                console.log(`‚úÖ [VOTACAO_AO_VIVO] N√ÉO: ${current} ‚Üí ${current + 1}`);
            } else if (voto === 'ABSTEN√á√ÉO') {
                const current = parseInt(voteNumbers[2].textContent) || 0;
                voteNumbers[2].textContent = current + 1;
                console.log(`‚úÖ [VOTACAO_AO_VIVO] ABSTEN√á√ÉO: ${current} ‚Üí ${current + 1}`);
            } else {
                console.warn('‚ö†Ô∏è [VOTACAO_AO_VIVO] Tipo de voto desconhecido:', voto);
            }
        }

        // Verificar se h√° vota√ß√£o ativa ao carregar a p√°gina
        async function checkVotacaoAtivaAoCarregar(camaraId) {
            try {
                console.log(`üîç [VOTACAO_AO_VIVO] Verificando vota√ß√µes ativas para c√¢mara ${camaraId}`);

                const response = await fetch(`/api/votacao-ao-vivo/status/${camaraId}`);
                if (!response.ok) {
                    console.log('üì¥ [VOTACAO_AO_VIVO] Nenhuma vota√ß√£o ativa encontrada');
                    return;
                }

                const data = await response.json();

                if (data.isLive && data.votacoes && data.votacoes.length > 0) {
                    // Restaurar estado da vota√ß√£o ativa
                    const votacao = data.votacoes[0]; // Pegar primeira vota√ß√£o ativa

                    console.log(`‚úÖ [VOTACAO_AO_VIVO] Vota√ß√£o ativa encontrada:`, votacao);

                    votacaoAoVivoAtiva = {
                        pautaId: votacao.pautaId,
                        pautaNome: votacao.pautaNome,
                        pautaDescricao: votacao.pautaDescricao || '',
                        sessaoNome: votacao.sessaoNome || '',
                        sessaoTipo: votacao.sessaoTipo || '',
                        sessaoDataHora: votacao.sessaoDataHora || null,
                        vereadoresOnline: votacao.vereadoresOnline || 0,
                        timestamp: votacao.timestamp
                    };

                    console.log('üîÑ [VOTACAO_AO_VIVO] Estado restaurado ao carregar p√°gina');
                } else {
                    console.log('üì¥ [VOTACAO_AO_VIVO] Nenhuma vota√ß√£o ativa no momento');
                }
            } catch (error) {
                console.error('‚ùå [VOTACAO_AO_VIVO] Erro ao verificar vota√ß√£o ativa:', error);
            }
        }

        document.addEventListener('DOMContentLoaded', async () => {
            // Inicializar anima√ß√µes unificadas
            initUnifiedAnimations();

            // Verificar se h√° c√¢mara selecionada
            await initializePortal();

            // Configurar bot√£o "Ver Todas as Pautas"
            setupVerTodasPautasButton();

            // Fun√ß√£o para inicializar o portal
            async function initializePortal() {
                try {
                    // Obter c√¢mara selecionada da URL ou localStorage
                    const selectedCamara = getCamaraFromUrl() || getCamaraFromStorage();

                    if (!selectedCamara) {
                        console.warn('‚ö†Ô∏è Nenhuma c√¢mara selecionada, redirecionando...');
                        window.location.href = 'selecionar_camara.html';
                        return;
                    }

                    console.log('üèõÔ∏è Carregando portal para:', selectedCamara);

                    // Carregar informa√ß√µes da c√¢mara
                    await loadCamaraInfo(selectedCamara.id, selectedCamara.nome);

                    // Carregar pr√≥ximas sess√µes
                    await loadProximasSessoes(selectedCamara.id);

                    // Carregar vereadores
                    await loadVereadores(selectedCamara.id);

                    // Carregar vota√ß√µes recentes
                    await loadVotacoesRecentes(selectedCamara.id);

                    // Carregar livestream inicial
                    await loadLivestream();

                    // Inicializar vota√ß√£o ao vivo WebSocket
                    initializeVotacaoAoVivoWebSocket();

                    // Verificar se h√° vota√ß√£o ativa ao carregar
                    await checkVotacaoAtivaAoCarregar(selectedCamara.id);

                    // Inicializar UI de vota√ß√£o ao vivo
                    updateVotacaoAoVivoUI();

                    // Nota: Polling desabilitado - usando WebSocket para atualiza√ß√µes em tempo real

                } catch (error) {
                    console.error('‚ùå Erro ao inicializar portal:', error);
                    // Em caso de erro, usar informa√ß√µes do localStorage se dispon√≠vel
                    const fallbackCamara = getCamaraFromStorage();
                    if (fallbackCamara) {
                        await loadCamaraInfo(fallbackCamara.id, fallbackCamara.nome);
                        await loadProximasSessoes(fallbackCamara.id);
                        await loadVereadores(fallbackCamara.id);
                        await loadVotacoesRecentes(fallbackCamara.id);
                        await loadLivestream();
                        initializeVotacaoAoVivoWebSocket();
                        updateVotacaoAoVivoUI();
                        startLivestreamPolling();
                    } else {
                        showError('Erro ao carregar informa√ß√µes da c√¢mara.');
                    }
                }
            }

            // Fun√ß√£o para obter c√¢mara da URL
            function getCamaraFromUrl() {
                const urlParams = new URLSearchParams(window.location.search);
                const camaraId = urlParams.get('camara');

                if (camaraId) {
                    const camaraNome = localStorage.getItem('selectedCamaraNome');
                    return { id: camaraId, nome: camaraNome || 'C√¢mara Municipal' };
                }
                return null;
            }

            // Fun√ß√£o para obter c√¢mara do localStorage
            function getCamaraFromStorage() {
                const camaraId = localStorage.getItem('selectedCamaraId');
                const camaraNome = localStorage.getItem('selectedCamaraNome');

                if (camaraId && camaraNome) {
                    return { id: camaraId, nome: camaraNome };
                }
                return null;
            }

            // Fun√ß√£o para carregar informa√ß√µes da c√¢mara
            async function loadCamaraInfo(camaraId, camaraNome) {
                try {
                    console.log('üìä Carregando dados da c√¢mara:', camaraId);

                    // Definir c√¢mara atual e inicializar WebSocket
                    currentCamaraId = camaraId;
                    initializeWebSocket();

                    // Atualizar UI com nome da c√¢mara
                    updateCamaraUI(camaraNome);

                    // Tentar carregar dados din√¢micos da API
                    const response = await fetch(`/api/camaras/${camaraId}/info`);

                    if (response.ok) {
                        const data = await response.json();
                        updateCamaraData(data);
                    } else {
                        console.warn('‚ö†Ô∏è API n√£o dispon√≠vel, usando dados mockados');
                        updateCamaraDataMock(camaraNome);
                    }

                } catch (error) {
                    console.warn('‚ö†Ô∏è Erro ao carregar dados da API, usando mockados:', error);
                    updateCamaraDataMock(camaraNome);
                }
            }

            // Fun√ß√£o para atualizar UI com nome da c√¢mara
            function updateCamaraUI(camaraNome) {
                // Atualizar t√≠tulo da p√°gina
                document.getElementById('pageTitle').textContent = `${camaraNome} - Portal da Transpar√™ncia`;

                // Atualizar navbar
                document.getElementById('camaraNomeNav').textContent = camaraNome;

                // Atualizar hero section
                document.getElementById('heroTitle').textContent = `${camaraNome}, Aberta para Voc√™`;

                console.log('‚úÖ UI atualizada com:', camaraNome);
            }

            // Fun√ß√£o para atualizar com dados reais da API
            function updateCamaraData(data) {
                console.log('üìä Dados da c√¢mara recebidos:', data);

                // Aqui voc√™ implementar√° a atualiza√ß√£o com dados reais
                // Por exemplo: sess√µes ativas, vereadores, etc.

                // Para agora, apenas log dos dados
                if (data.info) {
                    const info = data.info;
                    // Atualizar descri√ß√£o do hero com dados reais
                    if (info.municipio && info.estado) {
                        document.getElementById('heroDescription').textContent =
                            `Acompanhe as atividades da c√¢mara municipal de ${info.municipio}, ${info.estado}. Sess√µes ao vivo, vota√ß√µes e total transpar√™ncia.`;
                    }
                }
            }

            // Fun√ß√£o para dados mockados (fallback)
            function updateCamaraDataMock(camaraNome) {
                console.log('üé≠ Usando dados mockados para:', camaraNome);

                // Extrair nome da cidade do nome da c√¢mara
                const cidade = camaraNome.replace(/C√¢mara Municipal de?/gi, '').trim();

                if (cidade && cidade !== camaraNome) {
                    document.getElementById('heroDescription').textContent =
                        `Acompanhe as atividades da c√¢mara municipal de ${cidade}. Sess√µes ao vivo, vota√ß√µes e total transpar√™ncia.`;
                }
            }

            // Fun√ß√£o para carregar pr√≥ximas sess√µes
            async function loadProximasSessoes(camaraId) {
                console.log('üìÖ Carregando pr√≥ximas sess√µes da c√¢mara:', camaraId);
                const container = document.getElementById('sessoes-container');
                const loading = document.getElementById('sessoes-loading');

                try {
                    // Buscar sess√µes futuras da API real
                    const response = await fetch(`/api/camaras/${camaraId}/sessoes-futuras`);

                    if (!response.ok) {
                        throw new Error(`Erro ${response.status}: ${response.statusText}`);
                    }

                    const data = await response.json();
                    const sessoes = data.sessoes || [];

                    renderProximasSessoes(sessoes);
                    console.log('‚úÖ Pr√≥ximas sess√µes carregadas da API:', sessoes.length);

                } catch (error) {
                    console.error('‚ùå Erro ao carregar pr√≥ximas sess√µes da API:', error);
                    console.log('‚ö†Ô∏è Nenhuma sess√£o futura encontrada');

                    // Mostrar mensagem de "sem sess√µes" em vez de dados demo
                    renderProximasSessoes([]);
                }
            }

            // Fun√ß√£o para renderizar pr√≥ximas sess√µes
            function renderProximasSessoes(sessoes) {
                const container = document.getElementById('sessoes-container');
                const loading = document.getElementById('sessoes-loading');

                if (loading) {
                    loading.remove();
                }

                if (!sessoes || sessoes.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-calendar-times"></i>
                            <h3>Nenhuma sess√£o agendada</h3>
                            <p>N√£o h√° sess√µes programadas no momento. Novas sess√µes aparecer√£o aqui quando forem agendadas.</p>
                        </div>
                    `;
                    return;
                }

                // Se 4 ou menos sess√µes, usar grid est√°tico
                if (sessoes.length <= 4) {
                    renderSessoesGrid(sessoes, container);
                } else {
                    // Mais de 4 sess√µes, usar carrossel infinito
                    renderSessoesCarousel(sessoes, container);
                }
            }

            // Renderizar como grid est√°tico
            function renderSessoesGrid(sessoes, container) {
                const html = `
                    <div class="sessoes-grid">
                        ${sessoes.map(sessao => createSessaoCard(sessao)).join('')}
                    </div>
                `;
                container.innerHTML = html;
            }

            // Renderizar como carrossel infinito
            function renderSessoesCarousel(sessoes, container) {
                // Duplicar sess√µes para carrossel infinito
                const extendedSessoes = [...sessoes, ...sessoes];

                const html = `
                    <div class="sessoes-carousel-wrapper">
                        <div class="sessoes-carousel" id="sessoes-carousel">
                            ${extendedSessoes.map(sessao => createSessaoCard(sessao)).join('')}
                        </div>
                    </div>
                    <div class="carousel-controls">
                        <button class="carousel-btn" id="carousel-prev">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <div class="carousel-indicators" id="carousel-indicators">
                            ${sessoes.map((_, index) =>
                                `<div class="carousel-dot ${index === 0 ? 'active' : ''}" data-index="${index}"></div>`
                            ).join('')}
                        </div>
                        <button class="carousel-btn" id="carousel-next">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                `;

                container.innerHTML = html;
                initSessoesCarousel(sessoes.length);
            }

            // Criar HTML para card de sess√£o
            function createSessaoCard(sessao) {
                const dataDaSessao = new Date(sessao.data_sessao);
                const dataFormatada = dataDaSessao.toLocaleDateString('pt-BR', {
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                // Gerar classe do tipo baseado no tipo da sess√£o
                const tipoClass = sessao.tipo ? sessao.tipo.toLowerCase()
                    .replace('√£', 'a')
                    .replace(/\s+/g, '') : 'ordinaria';

                return `
                    <div class="sessao-card">
                        <div>
                            <div class="sessao-card-header">
                                <div class="sessao-date">${dataFormatada}</div>
                                <div class="tipo-badge ${tipoClass}">${sessao.tipo || 'Ordin√°ria'}</div>
                            </div>
                            <h3 class="sessao-title">${sessao.nome}</h3>

                            <div>
                                <h4 class="sessao-pautas-title">PAUTAS EM DESTAQUE</h4>
                                <ul class="sessao-pautas-list">
                                    <li class="sessao-pautas-item">Placeholder: Vota√ß√£o do or√ßamento municipal 2026</li>
                                    <li class="sessao-pautas-item">Placeholder: An√°lise do Projeto de Lei 046/2025</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Inicializar carrossel de sess√µes
            function initSessoesCarousel(totalSessoes) {
                const carousel = document.getElementById('sessoes-carousel');
                const prevBtn = document.getElementById('carousel-prev');
                const nextBtn = document.getElementById('carousel-next');
                const indicators = document.querySelectorAll('.carousel-dot');

                let currentIndex = 0;
                let isMoving = false;
                const cardWidth = 344; // 320px + 24px margin

                function moveCarousel(index) {
                    if (isMoving) return;
                    isMoving = true;

                    const translateX = -index * cardWidth;
                    carousel.style.transform = `translateX(${translateX}px)`;

                    // Atualizar indicadores
                    indicators.forEach((dot, i) => {
                        dot.classList.toggle('active', i === index);
                    });

                    setTimeout(() => {
                        // Reset infinito
                        if (index >= totalSessoes) {
                            carousel.style.transition = 'none';
                            carousel.style.transform = 'translateX(0px)';
                            currentIndex = 0;
                            indicators.forEach((dot, i) => {
                                dot.classList.toggle('active', i === 0);
                            });

                            setTimeout(() => {
                                carousel.style.transition = 'transform 0.5s ease-in-out';
                                isMoving = false;
                            }, 50);
                        } else {
                            currentIndex = index;
                            isMoving = false;
                        }
                    }, 500);
                }

                // Event listeners
                nextBtn.addEventListener('click', () => {
                    moveCarousel(currentIndex + 1);
                });

                prevBtn.addEventListener('click', () => {
                    const newIndex = currentIndex === 0 ? totalSessoes - 1 : currentIndex - 1;
                    moveCarousel(newIndex);
                });

                // Indicadores
                indicators.forEach((dot, index) => {
                    dot.addEventListener('click', () => {
                        moveCarousel(index);
                    });
                });

                // Auto-play (opcional)
                setInterval(() => {
                    if (!isMoving) {
                        moveCarousel(currentIndex + 1);
                    }
                }, 5000);
            }

            // Fun√ß√£o para carregar vereadores
            async function loadVereadores(camaraId) {
                console.log('üë• Carregando vereadores da c√¢mara:', camaraId);
                const container = document.getElementById('vereadores-container');
                const loading = document.getElementById('vereadores-loading');

                try {
                    // Buscar vereadores da API real
                    const response = await fetch(`/api/camaras/${camaraId}/vereadores`);

                    if (!response.ok) {
                        throw new Error(`Erro ${response.status}: ${response.statusText}`);
                    }

                    const data = await response.json();
                    const vereadores = data.vereadores || [];

                    renderVereadores(vereadores);
                    console.log('‚úÖ Vereadores carregados da API:', vereadores.length);

                } catch (error) {
                    console.error('‚ùå Erro ao carregar vereadores da API:', error);
                    console.log('‚ö†Ô∏è Usando dados de demonstra√ß√£o para desenvolvimento');

                    // Fallback com dados de demonstra√ß√£o
                    const mockVereadores = [
                        {
                            id: 'demo-1',
                            nome: 'Vereador Demo',
                            foto_url: 'https://via.placeholder.com/150/E5E7EB/6B7280?text=DEMO',
                            cargo: 'Vereador',
                            partido: {
                                nome: 'Partido Demo',
                                sigla: 'DEMO',
                                logo_url: 'https://via.placeholder.com/24x24/6B7280/FFFFFF?text=D'
                            }
                        }
                    ];

                    renderVereadores(mockVereadores);
                    console.log('üé≠ Vereadores carregados (demo):', mockVereadores.length);
                }
            }

            // Fun√ß√£o para renderizar vereadores
            function renderVereadores(vereadores) {
                const container = document.getElementById('vereadores-container');
                const loading = document.getElementById('vereadores-loading');

                if (loading) {
                    loading.remove();
                }

                if (!vereadores || vereadores.length === 0) {
                    container.innerHTML = `
                        <div class="container">
                            <div class="empty-state">
                                <i class="fas fa-users"></i>
                                <h3>Nenhum vereador cadastrado</h3>
                                <p>N√£o h√° vereadores cadastrados no sistema. As informa√ß√µes aparecer√£o aqui quando estiverem dispon√≠veis.</p>
                            </div>
                        </div>
                    `;
                    return;
                }

                // Calcular quantos vereadores cabem na tela
                const containerWidth = window.innerWidth - 40; // Descontar padding lateral
                const cardWidth = 304; // 280px + 24px margin
                const maxVisibleCards = Math.floor(containerWidth / cardWidth);

                // Se todos os vereadores cabem na tela, usar grid est√°tico
                if (vereadores.length <= maxVisibleCards) {
                    renderVereadoresGrid(vereadores, container);
                } else {
                    // N√£o cabem todos, usar carrossel
                    renderVereadoresCarousel(vereadores, container);
                }
            }

            // Renderizar como grid est√°tico para poucos vereadores
            function renderVereadoresGrid(vereadores, container) {
                const html = `
                    <div class="container">
                        <div class="vereadores-grid-static">
                            ${vereadores.map(vereador => createVereadorCardStatic(vereador)).join('')}
                        </div>
                        <div class="vereadores-info" style="justify-content: center; margin-top: 2rem; display: flex;">
                            <span>${vereadores.length} vereadores</span>
                        </div>
                    </div>
                `;
                container.innerHTML = html;
            }

            // Renderizar carrossel infinito de vereadores
            function renderVereadoresCarousel(vereadores, container) {
                // Duplicar vereadores para carrossel infinito suave
                const extendedVereadores = [...vereadores, ...vereadores];

                const html = `
                    <div class="vereadores-carousel-wrapper">
                        <div class="vereadores-carousel" id="vereadores-carousel">
                            ${extendedVereadores.map(vereador => createVereadorCard(vereador)).join('')}
                        </div>
                    </div>
                    <div class="vereadores-carousel-controls">
                        <button class="vereadores-carousel-btn" id="vereadores-prev">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <div class="vereadores-info">
                            <span>${vereadores.length} vereadores</span>
                        </div>
                        <button class="vereadores-carousel-btn" id="vereadores-next">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                `;

                container.innerHTML = html;
                initVereadoresCarousel(vereadores.length);
            }

            // Criar HTML para card de vereador (carrossel)
            function createVereadorCard(vereador) {
                let cargoFormatado = vereador.cargo || 'Vereador';
                if (cargoFormatado === 'Presidente da C√¢mara') {
                    cargoFormatado = 'Presidente';
                }

                return `
                    <div class="vereador-card">
                        <img src="${vereador.foto_url}" alt="${vereador.nome}" class="vereador-avatar"
                             onerror="this.src='https://via.placeholder.com/80x80/E5E7EB/6B7280?text=${vereador.nome.charAt(0)}'">
                        <h3 class="vereador-name">${vereador.nome}</h3>
                        <div class="vereador-party">
                            ${vereador.partido.logo_url ?
                                `<img src="${vereador.partido.logo_url}" alt="${vereador.partido.sigla}" class="partido-logo"
                                      onerror="this.style.display='none'">` :
                                ''
                            }
                            <span><strong>${vereador.partido.sigla}</strong> - ${cargoFormatado}</span>
                        </div>
                        <div class="vereador-stats">
                            <div class="stat-item">
                                <span class="number">${vereador.estatisticas?.percentual_presenca || 0}%</span>
                                <span class="label">Presen√ßa</span>
                            </div>
                            <div class="stat-item">
                                <span class="number">${vereador.estatisticas?.total_votacoes || 0}</span>
                                <span class="label">Vota√ß√µes</span>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Criar HTML para card de vereador est√°tico (sem margin-right)
            function createVereadorCardStatic(vereador) {
                let cargoFormatado = vereador.cargo || 'Vereador';
                if (cargoFormatado === 'Presidente da C√¢mara') {
                    cargoFormatado = 'Presidente';
                }

                return `
                    <div class="vereador-card" style="margin-right: 0;">
                        <img src="${vereador.foto_url}" alt="${vereador.nome}" class="vereador-avatar"
                             onerror="this.src='https://via.placeholder.com/80x80/E5E7EB/6B7280?text=${vereador.nome.charAt(0)}'">
                        <h3 class="vereador-name">${vereador.nome}</h3>
                        <div class="vereador-party">
                            ${vereador.partido.logo_url ?
                                `<img src="${vereador.partido.logo_url}" alt="${vereador.partido.sigla}" class="partido-logo"
                                      onerror="this.style.display='none'">` :
                                ''
                            }
                            <span><strong>${vereador.partido.sigla}</strong> - ${cargoFormatado}</span>
                        </div>
                        <div class="vereador-stats">
                            <div class="stat-item">
                                <span class="number">${vereador.estatisticas?.percentual_presenca || 0}%</span>
                                <span class="label">Presen√ßa</span>
                            </div>
                            <div class="stat-item">
                                <span class="number">${vereador.estatisticas?.total_votacoes || 0}</span>
                                <span class="label">Vota√ß√µes</span>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Inicializar carrossel de vereadores
            function initVereadoresCarousel(totalVereadores) {
                const carousel = document.getElementById('vereadores-carousel');
                const prevBtn = document.getElementById('vereadores-prev');
                const nextBtn = document.getElementById('vereadores-next');

                let currentIndex = 0;
                let isMoving = false;
                const cardWidth = 304; // 280px + 24px margin

                function moveCarousel(direction) {
                    if (isMoving) return;
                    isMoving = true;

                    if (direction === 'next') {
                        currentIndex++;
                    } else {
                        currentIndex--;
                    }

                    const translateX = -currentIndex * cardWidth;
                    carousel.style.transform = `translateX(${translateX}px)`;

                    setTimeout(() => {
                        // Reset infinito
                        if (currentIndex >= totalVereadores) {
                            carousel.style.transition = 'none';
                            carousel.style.transform = 'translateX(0px)';
                            currentIndex = 0;
                        } else if (currentIndex < 0) {
                            carousel.style.transition = 'none';
                            const resetTranslateX = -(totalVereadores - 1) * cardWidth;
                            carousel.style.transform = `translateX(${resetTranslateX}px)`;
                            currentIndex = totalVereadores - 1;
                        }

                        setTimeout(() => {
                            carousel.style.transition = 'transform 0.5s ease-in-out';
                            isMoving = false;
                        }, 50);
                    }, 500);
                }

                // Event listeners
                nextBtn.addEventListener('click', () => moveCarousel('next'));
                prevBtn.addEventListener('click', () => moveCarousel('prev'));

                // Auto-play mais lento para vereadores
                setInterval(() => {
                    if (!isMoving) {
                        moveCarousel('next');
                    }
                }, 7000);
            }

            // Fun√ß√£o para mostrar erro
            function showError(message) {
                console.error('‚ùå', message);
                document.getElementById('heroTitle').textContent = 'Erro ao Carregar Portal';
                document.getElementById('heroDescription').textContent = message;
            }
            // Fun√ß√£o para carregar vota√ß√µes recentes
            async function loadVotacoesRecentes(camaraId) {
                console.log('üó≥Ô∏è Carregando vota√ß√µes recentes da c√¢mara:', camaraId);
                const container = document.getElementById('votacoes-grid');
                const loading = document.getElementById('votacoes-loading');

                try {
                    // Buscar vota√ß√µes recentes da API
                    const response = await fetch(`/api/camaras/${camaraId}/votacoes-recentes`);

                    if (!response.ok) {
                        throw new Error(`Erro ${response.status}: ${response.statusText}`);
                    }

                    const data = await response.json();
                    const pautas = data.pautas || [];

                    renderVotacoesRecentes(pautas);
                    console.log('‚úÖ Vota√ß√µes recentes carregadas da API:', pautas.length);

                } catch (error) {
                    console.error('‚ùå Erro ao carregar vota√ß√µes recentes da API:', error);
                    console.log('‚ö†Ô∏è Usando dados de demonstra√ß√£o para desenvolvimento');

                    // Fallback com dados de demonstra√ß√£o
                    const mockPautas = [
                        {
                            id: 'demo-1',
                            nome: 'Projeto de Lei Demo 001/2025',
                            descricao: 'Institui o programa municipal de sustentabilidade e preserva√ß√£o ambiental',
                            autor: 'Vereador Demo',
                            status: 'APROVADA',
                            statusClass: 'approved',
                            sessao: { nome: 'Sess√£o Demo', data: new Date().toISOString() }
                        },
                        {
                            id: 'demo-2',
                            nome: 'Projeto de Lei Demo 002/2025',
                            descricao: 'Regulamenta o funcionamento do com√©rcio ambulante no centro da cidade',
                            autor: 'Vereadora Demo',
                            status: 'REPROVADA',
                            statusClass: 'rejected',
                            sessao: { nome: 'Sess√£o Demo', data: new Date().toISOString() }
                        },
                        {
                            id: 'demo-3',
                            nome: 'Projeto de Lei Demo 003/2025',
                            descricao: 'Cria√ß√£o do parque municipal e √°rea de lazer para a comunidade local',
                            autor: 'Vereador Demo 2',
                            status: 'APROVADA',
                            statusClass: 'approved',
                            sessao: { nome: 'Sess√£o Demo', data: new Date().toISOString() }
                        }
                    ];

                    renderVotacoesRecentes(mockPautas);
                    console.log('üé≠ Vota√ß√µes recentes carregadas (demo):', mockPautas.length);
                }
            }

            // Fun√ß√£o para renderizar vota√ß√µes recentes
            function renderVotacoesRecentes(pautas) {
                const container = document.getElementById('votacoes-grid');
                const loading = document.getElementById('votacoes-loading');

                if (loading) {
                    loading.remove();
                }

                if (!pautas || pautas.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state" style="grid-column: 1 / -1;">
                            <i class="fas fa-vote-yea"></i>
                            <h3>Nenhuma vota√ß√£o recente</h3>
                            <p>N√£o h√° vota√ß√µes registradas no momento. As vota√ß√µes aparecer√£o aqui conforme forem finalizadas.</p>
                        </div>
                    `;
                    return;
                }

                // Garantir que mostramos no m√°ximo 9 pautas
                const pautasLimitadas = pautas.slice(0, 9);

                const html = pautasLimitadas.map(pauta => createVotacaoCard(pauta)).join('');
                container.innerHTML = html;

                // Adicionar event listeners para os cards clic√°veis
                addVotacaoClickListeners();
            }

            // Adicionar event listeners para navega√ß√£o das vota√ß√µes
            function addVotacaoClickListeners() {
                const clickableCards = document.querySelectorAll('.clickable-card');
                clickableCards.forEach(card => {
                    card.addEventListener('click', function() {
                        const pautaId = this.getAttribute('data-pauta-id');
                        if (pautaId) {
                            navegarParaVotacao(pautaId);
                        }
                    });
                });
            }

            // Fun√ß√£o para adicionar nova pauta √†s vota√ß√µes recentes (via WebSocket)
            function addPautaToVotacoesRecentes(novaPauta) {
                console.log('üîÑ Adicionando nova pauta √†s vota√ß√µes recentes:', novaPauta);

                const container = document.getElementById('votacoes-grid');

                // Verificar se existem pautas atualmente
                const currentCards = container.querySelectorAll('.vote-card');
                const emptyState = container.querySelector('.empty-state');

                // Converter pauta para formato esperado pelo createVotacaoCard
                const pautaFormatada = {
                    id: novaPauta.id,
                    nome: novaPauta.nome,
                    descricao: novaPauta.descricao,
                    autor: novaPauta.autor,
                    status: formatarStatusParaExibicao(novaPauta.resultado_votacao),
                    statusClass: getStatusClass(novaPauta.resultado_votacao)
                };

                if (emptyState) {
                    // Se estava vazio, remover estado vazio e adicionar a primeira pauta
                    container.innerHTML = '';
                    const novoPautaHTML = createVotacaoCard(pautaFormatada);
                    container.innerHTML = novoPautaHTML;
                } else {
                    // Adicionar nova pauta no in√≠cio
                    const novoPautaHTML = createVotacaoCard(pautaFormatada);
                    container.insertAdjacentHTML('afterbegin', novoPautaHTML);

                    // Manter apenas 9 pautas (remover a √∫ltima se necess√°rio)
                    const allCards = container.querySelectorAll('.vote-card');
                    if (allCards.length > 9) {
                        allCards[allCards.length - 1].remove();
                        console.log('üóëÔ∏è Removida pauta mais antiga para manter limite de 9');
                    }
                }

                // Reconfigurar event listeners
                addVotacaoClickListeners();

                // Adicionar anima√ß√£o de destaque √† nova pauta
                const novoPautaElement = container.querySelector('.vote-card');
                if (novoPautaElement) {
                    novoPautaElement.style.border = '2px solid var(--accent-blue)';
                    novoPautaElement.style.transform = 'scale(1.02)';

                    // Remover destaque ap√≥s 3 segundos
                    setTimeout(() => {
                        novoPautaElement.style.border = '';
                        novoPautaElement.style.transform = '';
                    }, 3000);
                }

                console.log('‚úÖ Nova pauta adicionada com sucesso √†s vota√ß√µes recentes');
            }

            // --- Expor fun√ß√µes cr√≠ticas globalmente ---
            // O Socket.IO client e alguns handlers s√£o definidos em escopo global
            // (fora do callback DOMContentLoaded). Para evitar ReferenceError quando
            // um evento de WebSocket chega antes das fun√ß√µes locais serem
            // vis√≠veis, expomos as fun√ß√µes cr√≠ticas em window.
            try {
                window.addPautaToVotacoesRecentes = addPautaToVotacoesRecentes;
                window.loadVotacoesRecentes = loadVotacoesRecentes;
                window.addVotacaoClickListeners = addVotacaoClickListeners;
                window.updateVoteCountersUI = updateVoteCountersUI;
                window.connectToVotacaoWebSocket = connectToVotacaoWebSocket;
            } catch (exposureErr) {
                // Em navegadores muito antigos isso n√£o deve falhar, mas registramos
                // caso aconte√ßa para facilitar diagn√≥stico.
                console.warn('N√£o foi poss√≠vel expor fun√ß√µes globais do portal:', exposureErr);
            }

            // Fun√ß√£o auxiliar para formatar status para exibi√ß√£o
            function formatarStatusParaExibicao(resultadoVotacao) {
                switch(resultadoVotacao) {
                    case 'Aprovada': return 'APROVADA';
                    case 'Reprovada': return 'REPROVADA';
                    default: return 'FINALIZADA';
                }
            }

            // Fun√ß√£o auxiliar para obter classe CSS do status
            function getStatusClass(resultadoVotacao) {
                switch(resultadoVotacao) {
                    case 'Aprovada': return 'approved';
                    case 'Reprovada': return 'rejected';
                    default: return 'pending';
                }
            }

            // Criar HTML para card de vota√ß√£o
            function createVotacaoCard(pauta) {
                // Limitar descri√ß√£o a 100 caracteres para 2 linhas
                const descricaoLimitada = pauta.descricao && pauta.descricao.length > 100
                    ? pauta.descricao.substring(0, 100) + '...'
                    : pauta.descricao || 'Descri√ß√£o n√£o informada';

                return `
                    <div class="vote-card clickable-card" data-pauta-id="${pauta.id}">
                        <div class="vote-card-header">
                            <div class="vote-title">${pauta.nome}</div>
                            <div class="vote-badge-container">
                                <div class="result-badge ${pauta.statusClass}">${pauta.status}</div>
                            </div>
                        </div>
                        <div class="vote-info">
                            <p class="vote-description">${descricaoLimitada}</p>
                            <p class="vote-author">Autor: ${pauta.autor}</p>
                        </div>
                        <div class="vote-arrow">
                            <i class="fas fa-arrow-right"></i>
                        </div>
                    </div>
                `;
            }

            // Fun√ß√£o para navegar para p√°gina de vota√ß√£o p√∫blica
            function navegarParaVotacao(pautaId) {
                // Obter c√¢mara atual
                const camaraAtual = getCamaraFromUrl() || getCamaraFromStorage();

                if (!camaraAtual) {
                    console.error('C√¢mara n√£o encontrada');
                    return;
                }

                // Construir URL com par√¢metros
                const url = `votacao_publica.html?id=${pautaId}&camara=${camaraAtual.id}`;

                console.log('üîó Navegando para vota√ß√£o:', url);
                window.location.href = url;
            }

            // Fun√ß√£o para configurar o bot√£o "Ver Todas as Pautas"
            function setupVerTodasPautasButton() {
                const verTodasBtn = document.getElementById('ver-todas-pautas');
                if (verTodasBtn) {
                    verTodasBtn.addEventListener('click', () => {
                        // Obter ID da c√¢mara do localStorage ou URL
                        const camaraFromStorage = getCamaraFromStorage();
                        const camaraFromUrl = getCamaraFromUrl();
                        const camaraAtual = camaraFromUrl || camaraFromStorage;

                        console.log('üí° Funcionalidade "Ver Todas as Pautas" em desenvolvimento');
                        // Redirecionamento desabilitado - funcionalidade em breve
                        e.preventDefault();
                    });
                }
            }

            // === LIVESTREAM FUNCTIONALITY ===

            // Fun√ß√£o para carregar livestream da c√¢mara
            async function loadLivestream() {
                console.log('üì∫ Carregando livestream...');

                const camaraAtual = getCamaraFromUrl() || getCamaraFromStorage();
                if (!camaraAtual || !camaraAtual.id) {
                    console.log('‚ùå Nenhuma c√¢mara selecionada para livestream');
                    return;
                }

                try {
                    const response = await fetch(`/api/livestreams/camara/${camaraAtual.id}/display`);

                    if (response.ok) {
                        const result = await response.json();

                        if (result.data) {
                            displayLivestream(result.data, result.isLive);
                            console.log(`üì∫ Livestream carregada: ${result.data.title} (${result.isLive ? 'AO VIVO' : '√öLTIMA'})`);
                        } else {
                            hideLivestreamSection();
                            console.log('üì∫ Nenhuma livestream encontrada');
                        }
                    } else if (response.status === 404) {
                        hideLivestreamSection();
                        console.log('üì∫ Nenhuma livestream dispon√≠vel para esta c√¢mara');
                    } else {
                        console.error('‚ùå Erro ao carregar livestream:', response.status);
                        hideLivestreamSection();
                    }
                } catch (error) {
                    console.error('‚ùå Erro ao carregar livestream:', error);
                    hideLivestreamSection();
                }
            }


            // Fun√ß√£o para exibir livestream na interface
            function displayLivestream(livestreamData, isLive) {
                const sessionTitle = document.getElementById('session-status-title');
                const liveDot = document.getElementById('live-dot');
                const placeholderContent = document.getElementById('video-placeholder-content');
                const playerContainer = document.getElementById('youtube-player');
                const livestreamInfo = document.getElementById('livestream-info');
                const videoTitle = document.getElementById('livestream-video-title');
                const viewerCount = document.getElementById('livestream-viewer-count');

                // Configurar t√≠tulo e indicador
                if (isLive) {
                    sessionTitle.textContent = 'SESS√ÉO AO VIVO';
                    liveDot.className = 'live-dot';

                    // Exibir contador de visualiza√ß√µes se dispon√≠vel
                    if (livestreamData.concurrent_viewers) {
                        viewerCount.style.display = 'inline-flex';
                        viewerCount.innerHTML = `<i class="fas fa-eye"></i> ${livestreamData.concurrent_viewers} assistindo`;
                    } else {
                        viewerCount.style.display = 'none';
                    }
                } else {
                    sessionTitle.textContent = '√öLTIMA SESS√ÉO';
                    liveDot.className = 'live-dot ended';
                    viewerCount.style.display = 'none';
                }

                // Ocultar placeholder e exibir player
                placeholderContent.style.display = 'none';
                playerContainer.style.display = 'block';
                livestreamInfo.style.display = 'block';

                // Configurar t√≠tulo do v√≠deo
                videoTitle.textContent = livestreamData.title;

                // Destruir player anterior se existir
                if (youtubePlayer) {
                    youtubePlayer.destroy();
                    youtubePlayer = null;
                }

                // Limpar container do player
                playerContainer.innerHTML = '';

                // Aguardar API do YouTube estar dispon√≠vel
                const initPlayer = () => {
                    if (typeof YT !== 'undefined' && YT.Player) {
                        console.log('üì∫ Criando player YouTube para:', livestreamData.youtube_video_id);

                        // Criar novo player
                        youtubePlayer = new YT.Player(playerContainer, {
                            height: '100%',
                            width: '100%',
                            videoId: livestreamData.youtube_video_id,
                            playerVars: {
                                'autoplay': isLive ? 1 : 0,
                                'mute': isLive ? 1 : 0,
                                'controls': 1,
                                'showinfo': 0,
                                'rel': 0,
                                'modestbranding': 1,
                                'playsinline': 1
                            },
                            events: {
                                'onReady': function(event) {
                                    console.log('üì∫ Player YouTube pronto');
                                },
                                'onError': function(event) {
                                    console.error('üì∫ Erro no player YouTube:', event.data);
                                    // Fallback para iframe tradicional em caso de erro
                                    createFallbackPlayer(livestreamData, isLive, playerContainer);
                                }
                            }
                        });
                    } else {
                        // Se a API n√£o estiver dispon√≠vel, tentar novamente em 100ms
                        setTimeout(initPlayer, 100);
                    }
                };

                initPlayer();
            }

            // Fun√ß√£o fallback para criar iframe tradicional
            function createFallbackPlayer(livestreamData, isLive, container) {
                console.log('üì∫ Criando player fallback (iframe)');

                const iframe = document.createElement('iframe');
                iframe.width = '100%';
                iframe.height = '100%';
                iframe.frameBorder = '0';
                iframe.allowFullscreen = true;

                const embedUrl = isLive
                    ? `https://www.youtube.com/embed/${livestreamData.youtube_video_id}?autoplay=1&mute=1&controls=1&rel=0&modestbranding=1&playsinline=1`
                    : `https://www.youtube.com/embed/${livestreamData.youtube_video_id}?controls=1&rel=0&modestbranding=1&playsinline=1`;

                iframe.src = embedUrl;
                container.innerHTML = '';
                container.appendChild(iframe);
            }

            // Fun√ß√£o para ocultar livestream e mostrar placeholder
            function hideLivestreamSection() {
                const sessionTitle = document.getElementById('session-status-title');
                const liveDot = document.getElementById('live-dot');
                const placeholderContent = document.getElementById('video-placeholder-content');
                const player = document.getElementById('youtube-player');
                const livestreamInfo = document.getElementById('livestream-info');

                // Destruir player do YouTube se existir
                if (youtubePlayer) {
                    youtubePlayer.destroy();
                    youtubePlayer = null;
                }

                // Voltar ao estado original
                sessionTitle.textContent = 'SESS√ÉO AO VIVO';
                liveDot.className = 'live-dot';

                // Mostrar placeholder e ocultar player
                placeholderContent.style.display = 'flex';
                placeholderContent.querySelector('p').textContent = 'Nenhuma transmiss√£o dispon√≠vel';
                player.style.display = 'none';
                player.innerHTML = ''; // Limpar conte√∫do do player
                livestreamInfo.style.display = 'none';
            }

            // Fun√ß√£o para formatar dura√ß√£o em formato leg√≠vel
            function formatDuration(duration) {
                // Duration vem no formato ISO 8601 (PT4M13S) do YouTube
                const match = duration.match(/PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/);
                if (!match) return duration;

                const hours = parseInt(match[1]) || 0;
                const minutes = parseInt(match[2]) || 0;
                const seconds = parseInt(match[3]) || 0;

                if (hours > 0) {
                    return `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                } else {
                    return `${minutes}:${seconds.toString().padStart(2, '0')}`;
                }
            }

            // Fun√ß√£o para verificar periodicamente se o status da live mudou
            function startLivestreamPolling() {
                // Verificar a cada 30 segundos se h√° mudan√ßas no status da live
                setInterval(async () => {
                    const player = document.getElementById('youtube-player');
                    if (player && player.style.display !== 'none') {
                        await loadLivestream();
                    }
                }, 30000); // 30 segundos
            }

            // Limpeza ao sair da p√°gina
            window.addEventListener('beforeunload', () => {
                // Desconectar WebSocket principal
                if (socket && socket.connected) {
                    socket.disconnect();
                }

                // Desconectar WebSocket de vota√ß√£o ao vivo
                if (socketVotacaoAoVivo && socketVotacaoAoVivo.connected) {
                    socketVotacaoAoVivo.disconnect();
                }
            });

        });
    </script>
</body>
</html>